# blocks
Options -Indexes
ServerSignature Off

Header always unset Server
Header always unset X-Generator
Header always unset X-AspNet-Version
Header always unset X-AspNetMvc-Version
Header always unset X-Runtime
Header always unset X-Version
Header always unset X-Powered-By
Header always set X-Content-Type-Options "nosniff"
Header always set X-Frame-Options "SAMEORIGIN"
Header always set Content-Security-Policy "frame-ancestors 'self'"
Header always set X-XSS-Protection "1; mode=block"
Header always set Referrer-Policy "strict-origin-when-cross-origin"

<IfModule mod_expires.c>
    ExpiresActive On
    ExpiresByType image/jpg "access plus 1 year"
    ExpiresByType image/jpeg "access plus 1 year"
    ExpiresByType image/gif "access plus 1 year"
    ExpiresByType image/png "access plus 1 year"
    ExpiresByType image/svg+xml "access plus 1 year"
    ExpiresByType image/webp "access plus 1 year"
    ExpiresByType text/css "access plus 1 month"
    ExpiresByType text/javascript "access plus 1 month"
    ExpiresByType application/javascript "access plus 1 month"
    ExpiresByType application/x-font-ttf "access plus 1 year"
    ExpiresByType application/x-font-woff "access plus 1 year"
    ExpiresByType application/font-woff "access plus 1 year"
    ExpiresByType application/font-woff2 "access plus 1 year"
    ExpiresByType font/ttf "access plus 1 year"
    ExpiresByType font/woff "access plus 1 year"
    ExpiresByType font/woff2 "access plus 1 year"
</IfModule>

<IfModule mod_headers.c>
    <FilesMatch "\.(ico|pdf|flv|jpg|jpeg|png|gif|webp|svg|js|css|swf)$">
        Header set Cache-Control "public, max-age=31536000, no-transform"
    </FilesMatch>
    <FilesMatch "\.(html|htm)$">
        Header set Cache-Control "public, max-age=7200, must-revalidate"
    </FilesMatch>
</IfModule>

<FilesMatch "\.(htaccess|htpasswd|ini|phps|fla|psd|log|sh|lock|env|gitignore|md|sql|tpl|twig|blade\.php|conf|bat|ps)$">
    Order Allow,Deny
    Deny from all
</FilesMatch>

Order Allow,Deny
Allow from all

# 1. ПУСТЫЕ USER-AGENT
SetEnvIf User-Agent "^$" bad_bot
SetEnvIf User-Agent "^-?$" bad_bot

# !2. ФЕЙКОВЫЕ Chrome (версии 90- и 130+) не работает
#SetEnvIfNoCase User-Agent "chrome/([1-8][0-9]\.|90\.|1[3-9][0-9]\.|[2-9][0-9][0-9]\.)" bad_bot

# 3. УРЕЗАННЫЕ USER-AGENT
#SetEnvIfNoCase User-Agent "^mozilla/5\.0.*applewebkit/537\.36$" bad_bot

# 4. ВРЕДОНОСНЫЕ/АГРЕССИВНЫЕ БОТЫ
SetEnvIfNoCase User-Agent "trendictionbot" bad_bot
SetEnvIfNoCase User-Agent "geedo" bad_bot
SetEnvIfNoCase User-Agent "seranking" bad_bot
SetEnvIfNoCase User-Agent "timpibot" bad_bot
SetEnvIfNoCase User-Agent "semrushbot" bad_bot
SetEnvIfNoCase User-Agent "keys-so-bot" bad_bot
SetEnvIfNoCase User-Agent "wpbot" bad_bot
SetEnvIfNoCase User-Agent "dataforseo" bad_bot
SetEnvIfNoCase User-Agent "barkrowler" bad_bot
SetEnvIfNoCase User-Agent "seekport" bad_bot
SetEnvIfNoCase User-Agent "backlinks" bad_bot
SetEnvIfNoCase User-Agent "gigaexplorator" bad_bot
SetEnvIfNoCase User-Agent "terracotta" bad_bot

# 5. ЛЕГИТИМНЫЕ БОТЫ
SetEnvIfNoCase User-Agent "bytespider" bad_bot
SetEnvIfNoCase User-Agent "petalbot" bad_bot
SetEnvIfNoCase User-Agent "baidu" bad_bot
SetEnvIfNoCase User-Agent "oai-searchbot" bad_bot
#SetEnvIfNoCase User-Agent "meta-externalagent" bad_bot
#SetEnvIfNoCase User-Agent "gptbot" bad_bot
#SetEnvIfNoCase User-Agent "amazonbot" bad_bot
#SetEnvIfNoCase User-Agent "twitterbot" bad_bot
#SetEnvIfNoCase User-Agent "telegrambot" bad_bot
#SetEnvIfNoCase User-Agent "bingbot" bad_bot

Deny from env=bad_bot

# wp scan
Deny from 20.62.114.0
# /blocks
